var bodyWidth=document.body.clientWidth,bodyHeight=document.body.clientHeight,fps=60,frameTime=1e3/fps,getRandomInt=function(t,e){return Math.floor(Math.random()*(e-t))+t},getDegree=function(t){return t/Math.PI*180},getRadian=function(t){return t*Math.PI/180},debounce=function(t,e,i){var n;t.addEventListener(e,function(t){clearTimeout(n),n=setTimeout(function(){i(t)},500)},!1)},lastTimeRender,renderer,scene,canvas,camera,trackball,pointLight,ambientLight,boxObjArr=[],boxNum=192,threeStart=function(){initThree(),initCamera(),initLight();for(var t=0;boxNum>t;t++)boxObjArr[t]=new boxObj,boxObjArr[t].init(t);renderloop()},initThree=function(){canvas=document.getElementById("canvas"),renderer=new THREE.WebGLRenderer({antialias:!0}),renderer||alert("Three.jsの初期化に失敗しました。"),renderer.setSize(bodyWidth,bodyHeight),canvas.appendChild(renderer.domElement),renderer.setClearColor(0,1),scene=new THREE.Scene},initCamera=function(){camera=new THREE.PerspectiveCamera(45,bodyWidth/bodyHeight,1,4e3),camera.position.set(500,500,500),camera.up.set(0,0,1),camera.lookAt({x:0,y:0,z:0})},initLight=function(){var t;pointLight=new THREE.PointLight(16777215,1),pointLight.position.set(0,0,0),pointLightHelper=new THREE.PointLightHelper(pointLight,1),ambientLight=new THREE.AmbientLight(1118481),scene.add(pointLight),scene.add(ambientLight),t=new lightSphereObj,t.init()},lightSphereObj=function(){this.r=80,this.x=0,this.y=0,this.z=0,this.segments=24,this.geometry,this.material,this.mesh};lightSphereObj.prototype.init=function(){this.geometry=new THREE.SphereGeometry(this.r,this.segments),this.material=new THREE.MeshLambertMaterial({color:16777215,emissive:16777215,opacity:.9,transparent:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material),this.setPosition(),scene.add(this.mesh)},lightSphereObj.prototype.setPosition=function(){this.mesh.position.set(this.x,this.y,this.z)};var boxObj=function(){this.size=1,this.scale=0,this.rad=0,this.rad2=0,this.r=240,this.x=0,this.y=0,this.z=0,this.rotateX=0,this.rotateY=0,this.rotateZ=0,this.mesh},boxObjGeometry=new THREE.BoxGeometry(1,1,1),boxObjMaterial=new THREE.MeshLambertMaterial({color:16777215});boxObj.prototype.init=function(t){this.scale=getRandomInt(8,36),this.mesh=new THREE.Mesh(boxObjGeometry,boxObjMaterial),this.rad=getRadian(360*t/boxNum),this.rad2=getRadian(360*t*10/boxNum),this.changeScale(),this.changePositionVal(),this.setPosition(),this.changeRotationVal(),this.setRotation(),scene.add(this.mesh)},boxObj.prototype.changeScale=function(){this.mesh.scale.x=this.scale*this.size,this.mesh.scale.y=this.scale*this.size,this.mesh.scale.z=this.scale*this.size},boxObj.prototype.changePositionVal=function(){this.x=Math.cos(this.rad)*Math.cos(this.rad2)*this.r,this.y=Math.cos(this.rad)*Math.sin(this.rad2)*this.r,this.z=Math.sin(this.rad)*this.r},boxObj.prototype.setPosition=function(){this.mesh.position.set(this.x,this.y,this.z)},boxObj.prototype.changeRotationVal=function(){this.rotateX=2*this.rad,this.rotateY=2*this.rad,this.rotateZ=2*this.rad},boxObj.prototype.setRotation=function(){this.mesh.rotation.set(this.rotateX,this.rotateY,this.rotateZ)};var render=function(){renderer.clear();for(var t=0;t<boxObjArr.length;t++)boxObjArr[t].rad+=getRadian(.5),boxObjArr[t].rad2+=getRadian(.5),boxObjArr[t].changePositionVal(),boxObjArr[t].setPosition(),boxObjArr[t].changeRotationVal(),boxObjArr[t].setRotation();renderer.render(scene,camera)},renderloop=function(){var t=+new Date;requestAnimationFrame(renderloop),frameTime>t-lastTimeRender||(render(),lastTimeRender=+new Date)},resizeRenderer=function(){bodyWidth=document.body.clientWidth,bodyHeight=document.body.clientHeight,renderer.setSize(bodyWidth,bodyHeight),initCamera()};debounce(window,"resize",function(){resizeRenderer()}),threeStart();